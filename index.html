<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>BioJazz by LifeWorks</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1 class="header">BioJazz</h1>
        <p class="header">Evolving &amp; Design Biochemical Reaction Networks</p>

        <ul>
          <li class="download"><a class="buttons" href="https://github.com/LifeWorks/biojazz/zipball/master">Download ZIP</a></li>
          <li class="download"><a class="buttons" href="https://github.com/LifeWorks/biojazz/tarball/master">Download TAR</a></li>
          <li><a class="buttons github" href="https://github.com/LifeWorks/biojazz">View On GitHub</a></li>
        </ul>

        <p class="header">This project is maintained by <a class="header name" href="https://github.com/LifeWorks">LifeWorks</a></p>


      </header>
      <section>
        <h3>
<a name="introduction" class="anchor" href="#introduction"><span class="octicon octicon-link"></span></a>Introduction</h3>

<p>BioJazz is a tool for evolving and designing biochemical reaction networks using genetic algorithm (GA).  Typically, a BioJazz user wishes to evolve or design a small network or motif which accomplishes a specific function, such as a switch or an oscillator module.  The network comprises a set of proteins whose attributes are encoded in a network's ''genome''.  The ''genome'' is a binary string which  contains all the information necessary to determine how many proteins are present in the network, their structure, which proteins interact and the biochemical parameters of their interaction. </p>

<p>BioJazz implements a genetic algorithm which through a random process of replication, mutation, and selection (with either population-based or random walk style), attempts to incrementally improve how well those "genomes" perform a user-specified function. By encoding the network in a fashion that mimics the way nature does, BioJazz can use a larger variety of mutational operators than do traditional GAs (which use point mutations and crossover), such as gene duplications, gene deletions, and domain shuffling.  Thus, BioJazz has the ability to change and evolve networks with respect to both topology and biochemical parameters, by starting from a designed network ''_de novo_'', or a partially or completely functional seed network.</p>

<p>Much of BioJazz's ability to design realistic networks comes from the accompanying Allosteric Network Compiler (ANC).  ANC is a stand-alone, rule-based compiler which has the ability to turn a high-level description of allosteric proteins into the corresponding set of biochemical equations.  The proteins can exhibit many of the behaviours observed in nature, such as co-localization, allosteric transitions, binding and catalytic reactions.  BioJazz is likely the first tool to couple a rule-based compiler with an evolutionary algorithm.  </p>

<p>The principal user input consists of a scoring function, which evaluates a particular genome against the desired functionality, and returns a score reflecting the network's performance. This score is compared against the score of other networks to determine whether the network survives to the next generation and replicates.  Generally speaking, this involves applying a stimulus to the network and evaluating it's response.  Simulation of the network is accomplished by integrating a set of ordinary differential equations (ODEs) in ''Matlab''.  The required Matlab files are automatically generated from ANC's output using a tool called Facile.</p>

<p>BioJazz is highly configurable.  For example, the user can specify evolutionary parameters such as mutation rates.  Also, the user may restrict BioJazz to changing a subset of the network's attributes.  This is useful to "freeze" the network topology, with the effect that only the network's biochemical parameters and not its structure are allowed to evolve.  </p>

<p>While the genetic algorithm itself is not very tasking, scoring each individual of a population of genomes may require a lot of processing power. Therefore, BioJazz has an integrated capability to use workstation clusters to speed the computation.</p>

<p>The main features of BioJazz are:</p>

<ul>
<li>evolves both network topology and connection weights</li>
<li>designs a network ''_de novo_'', or starting from user-specified seed network</li>
<li>uses workstation clusters to speed up the design</li>
<li>produces a human-readable model of the winning network</li>
<li>highly configurable and parameterized</li>
</ul><h3>
<a name="getting-started" class="anchor" href="#getting-started"><span class="octicon octicon-link"></span></a>Getting Started</h3>

<h4>
<a name="installation" class="anchor" href="#installation"><span class="octicon octicon-link"></span></a>Installation</h4>

<p>BioJazz requires the ANC and Facile tools.  You can tell BioJazz where to get them by setting the ANC_HOME and FACILE_HOME environment variables to point to the appropriate directories.  It is recommended to add the following lines to your ''~/.bashrc'' file:</p>

<div class="highlight highlight-sh"><pre> <span class="nb">export </span><span class="nv">ANC_HOME</span>    <span class="o">=</span> ~/workspace/anc
 <span class="nb">export </span><span class="nv">FACILE_HOME</span> <span class="o">=</span> ~/workspace/facile
 <span class="nb">alias  </span><span class="nv">anc</span><span class="o">=</span><span class="s1">'$ANC_HOME/anc.pl'</span>
 <span class="nb">alias  </span><span class="nv">facile</span><span class="o">=</span><span class="s1">'$FACILE_HOME/facile.pl'</span>

 <span class="nb">export </span><span class="nv">BIOJAZZ_HOME</span> <span class="o">=</span> ~/workspace/biojazz
 <span class="nb">alias  </span><span class="nv">biojazz</span><span class="o">=</span><span class="s1">'$BIOJAZZ_HOME/biojazz.pl'</span>
</pre></div>

<p>BioJazz requires Matlab to be installed on all nodes used for computation, and assumes matlab can be started with the command ''matlab''. Here is an example of configuration in "~/.bashrc" file (on Mac OS X):</p>

<div class="highlight highlight-sh"><pre> <span class="nb">export </span><span class="nv">MATLAB_HOME</span> <span class="o">=</span> /Applications/MATLAB_R2011b.app/bin
 <span class="nb">alias  </span><span class="nv">matlab</span><span class="o">=</span><span class="s1">'$MATLAB_HOME/matlab'</span>
 <span class="nb">export </span><span class="nv">PATH</span> <span class="o">=</span> <span class="nv">$MATLAB_HOME</span>:<span class="nv">$PATH</span>

 <span class="nv">DYLD_LIBRARY_PATH</span> <span class="o">=</span> /Applications/MATLAB_R2011b.app/bin/maci64:/Applications/MATLAB_R2011b.app/sys/os/maci64:/Applications/MATLAB_R2011b.app/runtime/maci64:<span class="nv">$DYLD_LIBRARY_PATH</span>
 <span class="nb">export </span>DYLD_LIBRARY_PATH
</pre></div>

<p>Note that if you decide to use a cluster of workstations, these installation instructions apply to all workstations used.</p>

<h5>
<a name="cpan-modules" class="anchor" href="#cpan-modules"><span class="octicon octicon-link"></span></a>CPAN modules</h5>

<p>CPAN is an internet database of Perl modules.  BioJazz/ANC/Facile use several of them and they must be installed prior to use.  You will need system administrator priviledges to install these modules (or see  for instructions on how to install them in your home directory).  You or your sysadmin will typically need to run the following commands on each system used (use sudo as prefix if available, if you don't have a admin privilege <a href="http://twiki.org/cgi-bin/view/TWiki/HowToInstallCpanModules#Install_CPAN_modules_into_your_l">here is a solution</a> let you install perl modules in your user directory):</p>

<div class="highlight highlight-sh"><pre> cpan -i Class::Std
 cpan -i Class::Std::Storable
 cpan -i String::CRC32
 cpan -i Expect
 cpan -i Carp
 cpan -i WeakRef
 cpan -i IPC::Shareable
 cpan -i Linux::Pid
 cpan -i Text::CSV
</pre></div>

<p>Test your installation by running Facile, ANC and BioJazz without any arguments:</p>

<div class="highlight highlight-sh"><pre> <span class="nv">$FACILE_HOME</span>/facile.pl
 <span class="nv">$ANC_HOME</span>/anc.pl
 <span class="nv">$BIOJAZZ_HOME</span>/biojazz.pl
</pre></div>

<p>An error will be reported if any of the required modules are still missing.  Simply run CPAN again to install the missing module.</p>

<h5>
<a name="graphviz" class="anchor" href="#graphviz"><span class="octicon octicon-link"></span></a>GraphViz</h5>

<p>If you would like ANC to generate diagrams of the reaction network and species, you will the ''dot'' application and the following CPAN module:</p>

<div class="highlight highlight-sh"><pre> cpan -i GraphViz
</pre></div>

<h5>
<a name="ssh-agent" class="anchor" href="#ssh-agent"><span class="octicon octicon-link"></span></a>SSH Agent</h5>

<h4>
<a name="workspace-creation" class="anchor" href="#workspace-creation"><span class="octicon octicon-link"></span></a>Workspace Creation</h4>

<p>Depending on your specific application, BioJazz will require some customized configuration and scoring functions.  Also, during the course of a single design run, BioJazz will generate a large number of files.  For this reason, the user must create a properly configured workspace which will contain the appropriate configuration files, scoring functions, and design files.</p>

<p>To facilitate this, BioJazz can create the workspace for and populate it with the required directories and with template files to get you started.  To do this, run the following command:</p>

<div class="highlight highlight-sh"><pre> biojazz --command<span class="o">=</span><span class="s1">'create_workspace("bjazz")'</span>
</pre></div>

<p>This will create the directory <code>bjazz</code> and various sub-directories including <code>config</code> and <code>custom</code>.  Your configuration files go in the <code>config</code> directory, while your custom scoring functions go in the <code>custom</code> directory.  At this point, the user should familiarize him/herself with some the template files that are provided, and try to run BioJazz.  </p>

<p>The template file will try to design a network which contains a high concentration of dimers, and demonstrates how to use some of the functions available to the user.</p>

<div class="highlight highlight-sh"><pre> <span class="nb">cd </span>bjazz
 less config/template.cfg   <span class="c"># template configuration file</span>
 less config/Template.pm    <span class="c"># template application-specific scoring function</span>
</pre></div>

<h4>
<a name="running-biojazz" class="anchor" href="#running-biojazz"><span class="octicon octicon-link"></span></a>Running BioJazz</h4>

<p>After taking a look around, try to run BioJazz.  The <code>cluster_type</code> and <code>cluster_size</code> arguments override the specification contained in the configuration file, and will launch both slave nodes of the cluster on your machine.</p>

<div class="highlight highlight-sh"><pre> biojazz --config<span class="o">=</span>config/template.cfg --tag<span class="o">=</span>first_try --cluster_type<span class="o">=</span><span class="s2">"LOCAL"</span> --cluster_size<span class="o">=</span>2
</pre></div>

<p>This will evolve the network for only a couple generations.  The <code>tag</code> argument is very important.  In BioJazz, each design attempt is associated with a specific, user-specified tag.  BioJazz will create a directory in your workspace containing all the results and other files generated during the optimization.  This allows the user to attempt several optimizations simultaneously without fear of accidental loss of files.  The name of the design's working directory is <code>work_dir/tag</code>.  The <code>work_dir</code> parameter is specified in your configuration file (and has a value of <code>template</code> in this example).  Thus the results of the above run are contained in the directory <code>template/first_try</code>.</p>

<div class="highlight highlight-sh"><pre> <span class="o">[</span>user@host bjazz<span class="o">]</span><span class="nv">$ </span>ls -la template/test_main/
 total 168
 drwx------ 5 user group  4096 2008-06-03 14:53 .
 drwx------ 3 user group  4096 2008-06-03 14:51 ..
 drwx------ 2 user group  4096 2008-06-03 14:53 matlab
 drwx------ 2 user group  4096 2008-06-03 14:53 obj
 -rw------- 1 user group 71904 2008-06-03 14:53 ScorNode.0.20080603_145159.log
 -rw------- 1 user group 67215 2008-06-03 14:53 ScorNode.1.20080603_145159.log
 drwx------ 2 user group  4096 2008-06-03 14:51 source_2008-06-03-14:51:58
</pre></div>

<p>The <code>obj</code> directory contains all the genomes generated in a machine-readable form.  The <code>matlab</code> contains the models generated by ANC, and the <code>matlab</code> scripts generated by Facile.  The <code>ScorNode*</code> files are a log of the activity of each node in the cluster as work to compile and score genomes.  The <code>source*</code> directory is a snapshot of the source code used for that run such as your configuration and custom scoring files.</p>

<p>Now try modifying the configuration file to use other available workstations and run BioJazz again...</p>

<h4>
<a name="using-a-makefile" class="anchor" href="#using-a-makefile"><span class="octicon octicon-link"></span></a>Using a Makefile</h4>

<p>The program <em>make</em> is a UNIX classic and is useful in the context of BioJazz: not only for running BioJazz's suite of tests, but also as a sophisticated aliasing mechanism. A Makefile is provided when your workspace is created, which contains some useful functions and can serve as a template for customization. The table below documents a number of makefile targets which correspond to some of the most typical and common tasks you will perform.
Explaining how GNU's make program works is well beyond the scope of this document, but one of make's most useful switches is the dry-run (-n) switch. This switch will show you the commands to be executed, without actually executing them. You can use this to take a look at the BioJazz command and arguments that are generated for each of the targets below.</p>

<table>
<thead><tr>
<th><strong>Target(Arguments)</strong></th>
<th align="center"><strong>Example</strong></th>
<th align="center"><strong>Description</strong></th>
</tr></thead>
<tbody>
<tr>
<td><strong><em>Testing</em></strong></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr>
<td>test_custom (module)</td>
<td align="center">make test_custom module=MyDesign</td>
<td align="center">Executes the run_testcases routine that should be contained in your application-specific design class. Typically, the run_testcases routine should hand-craft a genome, then run your scoring function on this genome. This allows you to test your scoring function before trying to evolve some networks.</td>
</tr>
<tr>
<td>Evolution/Scoring</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr>
<td>evolve (config, tag, cluster_type, cluster_size)</td>
<td align="center">make evolve config=ultrasensitive.cfg tag=08jan01 cluster_type=SSH cluster_size=5</td>
<td align="center">Starts BioJazz and evolves a circuit as per the given configuration file. All output is echoed to your terminal saved to a logfile for subsequent analysis.</td>
</tr>
<tr>
<td>score (config, tag, genome)</td>
<td align="center">make score config=ultrasensitive.cfg tag=08jun25c genome=ultrasensitive/08jan01/obj/G199_I00.obj</td>
<td align="center">Runs your custom scoring function on the specified genome. All the files are created in the scratch space for this design. This target is useful for debugging unanticipated problems that crop up for a specific genome during an evolution run.</td>
</tr>
<tr>
<td><strong><em>Statistics</em></strong></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr>
<td>collect (config, tag)</td>
<td align="center">make collect config=ultrasensitive.cfg tag=08jan01</td>
<td align="center">Collects population data from the logfile generated during an evolution run, and save them to a file in object form.</td>
</tr>
<tr>
<td>analyze (config, tag)</td>
<td align="center">make analyze config=ultrasensitive.cfg tag=08jan01</td>
<td align="center">Reads the population data collected above and performs some simple analysis tasks such as finding the top-scoring individual and computing statistics. The results are saved to an Excel spreadsheet for charting.</td>
</tr>
<tr>
<td><strong><em>Shell</em></strong></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr>
<td>shell (config, tag)</td>
<td align="center"></td>
<td align="center">Starts BioJazz in shell mode.</td>
</tr>
<tr>
<td>load (config, tag, genome)</td>
<td align="center"></td>
<td align="center">Start BioJazz, load the specified genome, and go into shell mode.</td>
</tr>
<tr>
<td><strong><em>Admin/Utils</em></strong></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr>
<td>retag(config, old_tag, new_tag)</td>
<td align="center">make retag config=ultrasensitive.cfg old_tag=temp new_tag=08jan01</td>
<td align="center">Moves and renames design files as appropriate so that they appear under the new_tag.</td>
</tr>
<tr>
<td>clean (config, tag)</td>
<td align="center">make clean config=ultrasensitive.cfg tag=08jan01</td>
<td align="center">Deletes all design files of the given tag.</td>
</tr>
<tr>
<td>clean_all (config, tag)</td>
<td align="center">make clean_all config=ultrasensitive.cfg tag=08jan01</td>
<td align="center">Deletes all design files of the given tag, including those in the scratch space (generated by the score target).</td>
</tr>
</tbody>
</table><h4>
<a name="scoring-a-specific-genome" class="anchor" href="#scoring-a-specific-genome"><span class="octicon octicon-link"></span></a>Scoring a specific genome</h4>

<h4>
<a name="collecting-and-analyzing-statistics" class="anchor" href="#collecting-and-analyzing-statistics"><span class="octicon octicon-link"></span></a>Collecting and Analyzing Statistics</h4>

<h4>
<a name="biojazz-shell" class="anchor" href="#biojazz-shell"><span class="octicon octicon-link"></span></a>BioJazz Shell</h4>

<h4>
<a name="writing-and-testing-application-specific-functions" class="anchor" href="#writing-and-testing-application-specific-functions"><span class="octicon octicon-link"></span></a>Writing and Testing Application Specific Functions</h4>

<h5>
<a name="template-files" class="anchor" href="#template-files"><span class="octicon octicon-link"></span></a>Template Files</h5>

<h5>
<a name="testing" class="anchor" href="#testing"><span class="octicon octicon-link"></span></a>Testing</h5>

<h5>
<a name="debugging-when-things-go-wrong" class="anchor" href="#debugging-when-things-go-wrong"><span class="octicon octicon-link"></span></a>Debugging when things go wrong</h5>

<h4>
<a name="workspace-directory-structure" class="anchor" href="#workspace-directory-structure"><span class="octicon octicon-link"></span></a>Workspace Directory Structure</h4>

<div class="highlight highlight-sh"><pre> bjazz                               <span class="c"># workspace home</span>
   config                            <span class="c"># configuration files</span>
   custom                            <span class="c"># application-specific modules and functions (incl. scoring function)</span>
   <span class="nb">test</span>/custom                       <span class="c"># recommended location for test results of custom modules</span>
   <span class="nb">test</span>/modules                      <span class="c"># BioJazz module test results</span>
   mydesign                          <span class="c"># application-specific directory</span>
     mydesign.08jun01.log            <span class="c"># master node logfile</span>
     08jun01                         <span class="c"># results directory for run with TAG=08jun01</span>
       ScorNode.i.timestamp.log      <span class="c"># log file for slave node i</span>
       matlab                        <span class="c"># ANC genome models, eqn files, and matlab files</span>
       obj                           <span class="c"># genome objects in binary form</span>
</pre></div>

<h3>
<a name="evolutionary-algorithm" class="anchor" href="#evolutionary-algorithm"><span class="octicon octicon-link"></span></a>Evolutionary Algorithm</h3>

<p>BioJazz uses a genetic algorithm (GA) to search for a functional network.  The idea behind a genetic algorithm is to encode each candidate network as a ''genome'', which is just a sequence of bits having the value 0 or 1.  Given a population of individual network genomes, the GA calls a user-specified scoring function on each of the individuals in the population to determine it's ''fitness score''.  After computing the fitness scores, the GA creates a new generation of individual networks by cloning and mutating the previous generation in such a way that fitter individuals tend to have more descendants than less fit individuals.  Thus, depending on its relative fitness score, the fate of a particular individual network may be to:</p>

<ol>
<li><p>pass unchanged to the next generation (elite duplication)</p></li>
<li><p>generate one or more mutated clones (asexual duplication)</p></li>
<li><p>generate one or more children</p></li>
<li><p>have no descendants at all (elimination)</p></li>
</ol><p>Networks with a higher score has a better chance of fates i), ii) or iii) (i.e. surviving) than networks with a relatively lower score.</p>

<p>The number of creation created is such that the population size is kept constant from generation to generation.  The population size is specified via the parameter ''max_population''.</p>

<p>The following sections detail each step in the genetic algorithm.</p>

<h4>
<a name="initial-generation" class="anchor" href="#initial-generation"><span class="octicon octicon-link"></span></a>Initial Generation</h4>

<p>The initial generation can be either generated randomly or loaded from disk, as specified by the <code>initial_generation</code> parameter of the configuration file.  In the random case, the user can also specify the number of individuals to create (parameter <code>inum_genomes</code>) and the genome length (parameter -- currently fixed at 5000).  Loading from disk is useful to resume work on a partially completed design starting from the last generation created, or to load hand-crafted seed designs.  The following shows some examples for each case:</p>

<pre><code>    initial_genome = random                                    # random generation
    initial_genome = load test/modules/Ultrasensitive.obj      # load a hand-crafted network
    initial_genome = load ultrasensitive/test/obj/G427_I*.obj  # load all individuals of generation 427 of previous run
</code></pre>

<p>Regardless of how the initial generation is created, each individual is then stored under the following name in the working directory of the design:</p>

<pre><code>    $DESIGN_WORK/obj/G`ggg`_I`ii`.obj
</code></pre>

<p>Where <code>ggg</code> is the generation number and <code>ii</code> is the individual number.</p>

<h4>
<a name="scoring" class="anchor" href="#scoring"><span class="octicon octicon-link"></span></a>Scoring</h4>

<ul>
<li>the score_genome method of a user-defined scoring class is called to score individual networks</li>
<li>the scoring class inherits many useful method from ''Scoring''</li>
<li>describe Scoring class, its use of MatlabDriver, etc.</li>
</ul><h4>
<a name="replication" class="anchor" href="#replication"><span class="octicon octicon-link"></span></a>Replication</h4>

<p>There are two modes of replication in BioJazz.  They are rank-based and fitness-based replication.</p>

<h5>
<a name="rank-based-replication" class="anchor" href="#rank-based-replication"><span class="octicon octicon-link"></span></a>Rank-based replication</h5>

<p>In the rank-based mode, the fitness score returned by the user-defined evaluation routine are not used as is to compute the actual fitness of each network (the actual fitness being the expectation value for the number of children).  This mode is appropriate when small numerical differences in the score do not meaningfully correspond to the number of children an individual should have.  Therefore, BioJazz uses the fitness score of each individual to produce a ranking of the entire generation.</p>

<p>Children are generated according to the following procedure.  First, the top ''elite_pool_size'' individuals are copied as is to the next generation, without any mutations.  Next, an additional (''max_population'' - ''elite_pool_size'') children need to be created to keep the population size constant.  </p>

<h5>
<a name="fitness-based-replication" class="anchor" href="#fitness-based-replication"><span class="octicon octicon-link"></span></a>Fitness-based replication</h5>

<p>In this mode, the computed fitness dictates the relative proportion of the available pool of children that a genome is to have.</p>

<p>Children are generated according to the following procedure.  First, the top ''elite_pool_size'' individuals are copied as is to the next generation, without any mutations.  Next, an additional (''max_population'' - ''elite_pool_size'') children need to be created to keep the population size constant.  Each individual in the current generation is a potential parent and its expected number of children is proportional to the fitness computed from the ranking as described above.  </p>

<p>To decide which individuals become parents a sampling procedure called the "roulette wheel" is used.  Imagine a roulette wheel where each parent has a slot whose size is proportional to the fitness....</p>

<h4>
<a name="mutation-operators" class="anchor" href="#mutation-operators"><span class="octicon octicon-link"></span></a>Mutation Operators</h4>

<h5>
<a name="point-mutation" class="anchor" href="#point-mutation"><span class="octicon octicon-link"></span></a>Point Mutation</h5>

<h5>
<a name="gene-duplication" class="anchor" href="#gene-duplication"><span class="octicon octicon-link"></span></a>Gene Duplication</h5>

<h5>
<a name="gene-deletion" class="anchor" href="#gene-deletion"><span class="octicon octicon-link"></span></a>Gene Deletion</h5>

<h5>
<a name="domain-duplication" class="anchor" href="#domain-duplication"><span class="octicon octicon-link"></span></a>Domain Duplication</h5>

<h5>
<a name="domain-deletion" class="anchor" href="#domain-deletion"><span class="octicon octicon-link"></span></a>Domain Deletion</h5>

<h5>
<a name="domain-shuffling" class="anchor" href="#domain-shuffling"><span class="octicon octicon-link"></span></a>Domain Shuffling</h5>

<h3>
<a name="network-encoding-model" class="anchor" href="#network-encoding-model"><span class="octicon octicon-link"></span></a>Network Encoding Model</h3>

<h4>
<a name="complementarity-encoding-scheme" class="anchor" href="#complementarity-encoding-scheme"><span class="octicon octicon-link"></span></a>Complementarity Encoding Scheme</h4>

<p>The complementarity encoding scheme is currently implemented in BioJazz.</p>

<table>
<thead><tr>
<th>Field Name</th>
<th align="center">Length (L)</th>
<th align="center">Allowed Values RegExp</th>
<th align="center">Scaling</th>
<th align="center">Dynamic Range</th>
<th align="center">Resolution</th>
<th align="center">Description</th>
</tr></thead>
<tbody>
<tr>
<td><strong>Genome</strong></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr>
<td>PRE_JUNK</td>
<td align="center">Any</td>
<td align="center">[01]*</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">Untranslated sequence preceding first gene</td>
</tr>
<tr>
<td><em>genes</em></td>
<td align="center">1 or more genes</td>
<td align="center">Any legal gene</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">One or more genes separated by untranslated sub-sequences</td>
</tr>
<tr>
<td>POST_JUNK</td>
<td align="center">Any</td>
<td align="center">[01]*</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">Untranslated sequence following last gene</td>
</tr>
<tr>
<td><strong>Genw</strong></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr>
<td>START_CODE</td>
<td align="center">8</td>
<td align="center">01111110</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">Untranslated sequence preceding first gene</td>
</tr>
<tr>
<td>concentration</td>
<td align="center">10</td>
<td align="center">[01]{L}</td>
<td align="center">Log-linear</td>
<td align="center">1e3/1e-3</td>
<td align="center">1.36%</td>
<td align="center">Encodes the initial concentration of the protein</td>
</tr>
<tr>
<td>UNUSED</td>
<td align="center">4</td>
<td align="center">[01]{L}</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">Reserved field</td>
</tr>
<tr>
<td><em>domains</em></td>
<td align="center">1 or more domains</td>
<td align="center">Any legal domain</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">One or more domains separated by a soft linker pattern ("001")</td>
</tr>
<tr>
<td>STOP_CODE</td>
<td align="center">3</td>
<td align="center">111</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">Terminates the gene</td>
</tr>
<tr>
<td><strong>Domain</strong></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr>
<td>allosteric flag</td>
<td align="center">1</td>
<td align="center">[01]{1}</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">Maps directly to ANC domain attribute of the same name</td>
</tr>
<tr>
<td>R &lt;--&gt; T rates</td>
<td align="center">10</td>
<td align="center">[01]{L}</td>
<td align="center">Loglinear</td>
<td align="center">1e+2/1e-2</td>
<td align="center">0.90%</td>
<td align="center">Embedded in ANC model</td>
</tr>
<tr>
<td>Φ</td>
<td align="center">10</td>
<td align="center">[01]{10}</td>
<td align="center">Linear</td>
<td align="center">0.0 - 1.0</td>
<td align="center">~1e-3</td>
<td align="center">Scaled to a number between 0 and 1 (inclusive), embedded in ANC model</td>
</tr>
<tr>
<td>UNUSED</td>
<td align="center">4</td>
<td align="center">[01]{L}</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">Reserved field</td>
</tr>
<tr>
<td><em>protodomains</em></td>
<td align="center">1 or more protodomains</td>
<td align="center">Any legal protodomain</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">One or more protodomains separated by a hard linker pattern ("000")</td>
</tr>
<tr>
<td><strong>ProtoDomain</strong></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr>
<td>type</td>
<td align="center">2</td>
<td align="center">[01]{2}</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">Maps to protodomain type in ANC model, determines enzyme polarity. 00=bsite, 01=msite, 10=csite, 11=csite</td>
</tr>
<tr>
<td>substrate polarity</td>
<td align="center">1</td>
<td align="center">[01]{1}</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">If the protodomain is a csite, determines whether it modifies (0, kinase) or unmodifies (1, phosphatase) the substrate</td>
</tr>
<tr>
<td>binding profile</td>
<td align="center">10</td>
<td align="center">[01]{L}</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">Determines ligands pairs. If the binding profiles of two protodomains are sufficiently complementary, then a binding reaction occurs using kinetic rates calculated from the following attributes</td>
</tr>
<tr>
<td>kf profile</td>
<td align="center">20</td>
<td align="center">[01]{L}</td>
<td align="center">Log-linear profile</td>
<td align="center">1e3/1e-3</td>
<td align="center">1.99x</td>
<td align="center">Determines the association kinetics of two protodomains</td>
</tr>
<tr>
<td>kb profile</td>
<td align="center">20</td>
<td align="center">[01]{L}</td>
<td align="center">Loglinear-profile</td>
<td align="center">1e3/1e-3</td>
<td align="center">1.99x</td>
<td align="center">Determines the dissociation kinetics of two protodomains</td>
</tr>
<tr>
<td>kp profile</td>
<td align="center">10</td>
<td align="center">[01]{L}</td>
<td align="center">Loglinear</td>
<td align="center">1e3/1e-3</td>
<td align="center">1.36%</td>
<td align="center">For csite protodomains only, determines rate of product reaction when modifying</td>
</tr>
<tr>
<td>Keq ratio (Γ)</td>
<td align="center">10</td>
<td align="center">[01]{10}</td>
<td align="center">Loglinear</td>
<td align="center">1e2/1e-2</td>
<td align="center">0.90%</td>
<td align="center">Determines allosteric effect of msite modification. Embedded in ANC model</td>
</tr>
<tr>
<td>kf polarity mask</td>
<td align="center">20</td>
<td align="center">[01]{L}</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">XORed with "kf profile" to determine profile of modified (msite=1) version of protodomain</td>
</tr>
<tr>
<td>kf conformation mask</td>
<td align="center">20</td>
<td align="center">[01]{L}</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">XORed with "kf profile" to determine new profile of 'T' conformation</td>
</tr>
<tr>
<td>kb polarity mask</td>
<td align="center">20</td>
<td align="center">[01]{L}</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">XORed with "kb profile" to determine profile of modified (msite=1) version of protodomain</td>
</tr>
<tr>
<td>kb conformation mask</td>
<td align="center">20</td>
<td align="center">[01]{8}</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">XORed with "kb profile" to determine new profile of 'T' conformation</td>
</tr>
<tr>
<td>kp conformation mask</td>
<td align="center">10</td>
<td align="center">[01]{8}</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">XORed with "kp profile" to determine new profile of 'T' conformation</td>
</tr>
<tr>
<td>UNUSED</td>
<td align="center">4</td>
<td align="center">[01]{L}</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">Reserved field</td>
</tr>
</tbody>
</table><h4>
<a name="field-scaling" class="anchor" href="#field-scaling"><span class="octicon octicon-link"></span></a>Field Scaling</h4>

<p>All the above fields correspond to parameter values whose scale and dynamic range is given in a configuration file.  This section deals with the issue of translating an integer (binary encoded) scale into parameter values.  In all sections, x is the integer value corresponding to a binary field, which goes from 0 to x_max=2^L-1 where L is the length of the field.  Also, y_min is the minimum value of the parameter, and y_max is the maximum value.  For example, the regulated_concentration parameter can be made to range from 1e-3 (y_min) to 1e+3 (y_max).</p>

<h5>
<a name="linearly-scaled-fields" class="anchor" href="#linearly-scaled-fields"><span class="octicon octicon-link"></span></a>Linearly Scaled Fields</h5>

<p>Relevant field(s): Φ.</p>

<p>Here the value of the parameter is y(x) = y_min + (y_max - y_min)*(x/x_max);</p>

<p>The resolution R(n) for an n-bit field is given by:</p>

<p>R(n) = (y_max-y_min)/(2^n-1)</p>

<h5>
<a name="loglinear-scaled-fields" class="anchor" href="#loglinear-scaled-fields"><span class="octicon octicon-link"></span></a>Loglinear Scaled Fields</h5>

<p>Relevant field(s): kp_profile, RT/TR_transition_rate, Keq_ratio, regulated_concentration</p>

<p>y(x) = y_min * (y_max/y_min)^(x/x_max), or</p>

<p>log(y) = log(y0) + (x/x_max)*log(y_max/y_min)</p>

<p>The fold-change between two values of x which differ by 1.0 is:</p>

<p>FC = y(x+1)/y(x) = (y_max/y_min)^(1/x_max).</p>

<p>For example, an L=8-bit field associated with a dynamic range of y_max/y_min = 1e6 implies xmin=0, x_max=2^L-1=255 and a fold-change per increment of x of:</p>

<p>FC(8bits) = 1e6^(1/255) = 1.0557</p>

<p>In other words, you can change by 5.57% increments.  For 10 bits,</p>

<p>FC(10bits) = 1e6^(1/1023) = 1.0136.</p>

<h5>
<a name="loglinear-scaled-profiles" class="anchor" href="#loglinear-scaled-profiles"><span class="octicon octicon-link"></span></a>Loglinear Scaled Profiles</h5>

<p>Fields: kf_profile, kb_profile</p>

<p>Profiles do not directly encode parameters, but instead are compared to each other after applying a special complement() function to either one of the arguments.  The result of this comparison is used to obtain a Hamming distance of 0 to at most L.  This Hamming distance is then scaled log-linearly.  Thus if two profiles are 8 bits long, x_min=0 and x_max=L=8, so for a dynamic range of 1e6 we have</p>

<p>FC = 1e6^(1/8) = 5.6234</p>

<p>I.e. a 560% change per increment.  More appropriate would be to use 10-30 bits:</p>

<p>FC(10) = 1e6^(1/10) = 3.9811</p>

<p>FC(20) = 1e6^(1/20) = 1.9953</p>

<p>FC(30) = 1e6^(1/30) = 1.5849</p>

<p>I.e. a 2x or 60% change per increment.</p>

<h6>
<a name="improvement" class="anchor" href="#improvement"><span class="octicon octicon-link"></span></a>Improvement</h6>

<p>Note that there is some inefficiency in this method of coding because we need extremely long fields to get good resolution,  because x_max=L and not 2^L.</p>

<p>Currently for profiles X and Y, we have:</p>

<p>MISMATCH_VECTOR = XOR(X, complement(Y))
MISMATCH = ones(MISMATCH_VECTOR)</p>

<p>Equivalently, </p>

<p>MISMATCH = HAMMING(X, complement(Y))</p>

<p>An alternative would scale the MISMATCH_VECTOR, which has a range of 2^L, instead of MISMATCH, which has a range of just L.  Caveat is that we must get the same thing if the profiles are commuted, but in fact the MISMATCH_VECTOR gets flipped, so the msb becomes the lsb.  One way around this is to designate the 2 outer bits as msbs, and the 2 most inner bits as lsbs.  You break the MISMATCH_VECTOR in two, flip the 2nd half and add to the first.  This gets us a range of 0 to [2^(L/2)-1]*2.</p>

<h3>
<a name="scoring-functions" class="anchor" href="#scoring-functions"><span class="octicon octicon-link"></span></a>Scoring Functions</h3>

<h3>
<a name="authors-and-contributors" class="anchor" href="#authors-and-contributors"><span class="octicon octicon-link"></span></a>Authors and Contributors</h3>

<p>The project is firstly developed by Julien Ollivier, then modified and currently maintained by Song Feng (<a href="https://github.com/LifeWorks" class="user-mention">@LifeWorks</a>).</p>

<h3>
<a name="support-or-contact" class="anchor" href="#support-or-contact"><span class="octicon octicon-link"></span></a>Support or Contact</h3>

<p>If have any problems, please contact <a href="https://github.com/LifeWorks" class="user-mention">@LifeWorks</a> or email <a href="mailto:lifeworks.song@gmail.com">lifeworks.song@gmail.com</a></p>
      </section>
      <footer>
        <p><small>Hosted on <a href="https://pages.github.com">GitHub Pages</a> using the Dinky theme</small></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
		
  </body>
</html>